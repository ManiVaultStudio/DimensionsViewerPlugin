<!DOCTYPE html>
<html style="padding: 0; margin: 0; width: 100%; height: 100%;">
<head>
    <script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega@5"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-lite@4"></script>
    <script src="https://cdn.jsdelivr.net/npm/vega-embed@5"></script>
    <script type="text/javascript" src="qrc:///DimensionsViewer.js"></script>

</head>
	<body style="padding: 0; margin: 0; width: 100%; height: 100%;">
		<div id="view" style="width: 100%; height: 100%; overflow: hidden; "></div>
		<script>
            var onDimensionsChanged = function (dimensions) {
                let changeset = vega.changeset().remove(() => true).insert(dimensions);
                view.change('dimensions', changeset).run();
			}

			new QWebChannel(qt.webChannelTransport,
				function (channel) {
                    var dimensionsViewer = channel.objects.dimensionsViewer;

                    dimensionsViewer.changed.connect(onDimensionsChanged);
				});

            var options = {
                actions: {
                    export: false,
                    source: false,
                    compiled: false,
                    editor: false
                },
                renderer: "canvas",
                defaultStyle: false
                //padding: 100
            };

            vegaEmbed('#view', design, options).then(p => {
                element = document.getElementsByTagName("details");

                for (index = 0; index < element.length; index++) {
                    element[index].parentNode.removeChild(element[index]);
                }

                window.view = p.view
            });
		</script>
	</body>
</html>