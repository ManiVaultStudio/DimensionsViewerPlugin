<!DOCTYPE html>
<html>
<head>
    <script type="text/javascript" src="qrc:///qtwebchannel/qwebchannel.js"></script>
    <script type="text/javascript" src="qrc:///Vega.js"></script>
    <script type="text/javascript" src="qrc:///VegaEmbed.js"></script>
    <script type="text/javascript" src="qrc:///DimensionsViewer.js"></script>
</head>
	<body>
		<div id="view"></div>
		<script>
            var onDimensionsChanged = function (dimensions) {
                let changeset = vega.changeset().remove(() => true).insert(JSON.parse(dimensions));
                view.change('dimensions', changeset).run()
			}

			new QWebChannel(qt.webChannelTransport,
				function (channel) {
					var dimensionsViewer = channel.objects.dimensionsViewer;
                    dimensionsViewer.changed.connect(onDimensionsChanged);
				});

			vegaEmbed('#view', design).then(p => window.view = p.view);
		</script>
	</body>
</html>